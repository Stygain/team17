<html>

<link href="/assets/css/AcesUp.css" rel="stylesheet">
<script type="text/javascript" src="/assets/webjars/jquery/2.1.3/jquery.js"></script>

<body>

<header>
<a href="#"><h1 class="site-title"><center><b>Aces Up Solitaire</b></center></h1></a>
<nav class="navbar">
	<center>
        <ul class="navlist">
            <li class="navitem navlink"><button id="newStG">New Standard Game</button></li>
			<li class="navitem navlink"><button id="newSpG">New Spanish Game</button></li>
        </ul>
		</center>
    </nav>
</header>

<img src="https://cdn2.iconfinder.com/data/icons/freecns-cumulus/16/519660-164_QuestionMark-128.png" id="helpBut" />
<div id="infobox" display="none">
    <h4>General Rules:</h4>
    <ol>
        <li>Deal cards with the deal button</li>
        <li>When a card of the same suit and of lower number is present with a card of the same suit and higher number, the lower number card can be removed</li>
        <li>When you have an empty column you can choose to move a card there with the move button</li>
        <li>For more specific rules, consult the <a target="_blank" href="https://en.wikipedia.org/wiki/Aces_Up">wikipedia page</a></li>
    </ol>
    <h4>Spanish Deck Rules:</h4>
    <ul>
        <li>Suits: bastos (clubs), oros (golden coins), copas (cups), and espadas (swords).</li>
        <li>Contains 50 cards: nine ranked cards per suit (1-9), three face cards per suit (10-12), and 2 comodines cards (Jokers).</li>
        <li>The Joker cards are considered wild cards, which means they match with any suit and act as the highest valued card for that suit, which means you can remove any card from the top of a pile. However, once the Joker card has been matched with another card in the game, both cards are removed from the game.</li>
    </ul>
    <h4>How to Play:</h4>
    <ul>
        <li>Hit the deal button to deal four cards to the screen</li>
        <li>Use the remove button to remove a card from a column</li>
        <li>Enter the column you want to move a card from, followed by where you want to move it to, and hit the move button to move the cards</li>
    </ul>
</div>
<script type="text/javascript">
var x = document.getElementById('infobox');
x.style.display = "none";
document.getElementById('helpBut').addEventListener("click", function(event) {
    (function(event) {
        
		console.log("display is " + x.style.display);
        if (x.style.display === "none") {
			console.log("converting to block");
            x.style.display = "block";
        } else {
            x.style.display = "none";
        }
    }).call(document.getElementById('helpBut'), event);
});

</script>
<center>
<table>
    

    <tr><td class="columnOfCards" id="c0">
        <table>
            <p>Column 1</p>
            <tr><td class="cardLocation l0"></td></tr>
            <tr><td class="cardLocation l1"></td></tr>
            <tr><td class="cardLocation l2"></td></tr>
            <tr><td class="cardLocation l3"></td></tr>
            <tr><td class="cardLocation l4"></td></tr>
            <tr><td class="cardLocation l5"></td></tr>
            <tr><td class="cardLocation l6"></td></tr>
            <tr><td class="cardLocation l7"></td></tr>
            <tr><td class="cardLocation l8"></td></tr>
            <tr><td class="cardLocation l9"></td></tr>
            <tr><td class="cardLocation l10"></td></tr>
            <tr><td class="cardLocation l11"></td></tr>
            <tr><td class="cardLocation l12"></td></tr>
            <tr><td class="cardLocation l13"></td></tr>
        </table>
		<button id="Remove1">Remove</button>
    </td>
        <td class="columnOfCards" id="c1">
            <table>
                <p>Column 2</p>
                <tr><td class="cardLocation l0"></td></tr>
                <tr><td class="cardLocation l1"></td></tr>
                <tr><td class="cardLocation l2"></td></tr>
                <tr><td class="cardLocation l3"></td></tr>
                <tr><td class="cardLocation l4"></td></tr>
                <tr><td class="cardLocation l5"></td></tr>
                <tr><td class="cardLocation l6"></td></tr>
                <tr><td class="cardLocation l7"></td></tr>
                <tr><td class="cardLocation l8"></td></tr>
                <tr><td class="cardLocation l9"></td></tr>
                <tr><td class="cardLocation l10"></td></tr>
                <tr><td class="cardLocation l11"></td></tr>
                <tr><td class="cardLocation l12"></td></tr>
                <tr><td class="cardLocation l13"></td></tr>
            </table>
			<button id="Remove2">Remove</button>
        </td>
        <td class="columnOfCards" id="c2">
            <table>
                <p>Column 3</p>
                <tr><td class="cardLocation l0"></td></tr>
                <tr><td class="cardLocation l1"></td></tr>
                <tr><td class="cardLocation l2"></td></tr>
                <tr><td class="cardLocation l3"></td></tr>
                <tr><td class="cardLocation l4"></td></tr>
                <tr><td class="cardLocation l5"></td></tr>
                <tr><td class="cardLocation l6"></td></tr>
                <tr><td class="cardLocation l7"></td></tr>
                <tr><td class="cardLocation l8"></td></tr>
                <tr><td class="cardLocation l9"></td></tr>
                <tr><td class="cardLocation l10"></td></tr>
                <tr><td class="cardLocation l11"></td></tr>
                <tr><td class="cardLocation l12"></td></tr>
                <tr><td class="cardLocation l13"></td></tr>
            </table>
			<button id="Remove3">Remove</button>
        </td>
        <td class="columnOfCards" id="c3">
            <table>
                <p>Column 4</p>
                <tr><td class="cardLocation l0"></td></tr>
                <tr><td class="cardLocation l1"></td></tr>
                <tr><td class="cardLocation l2"></td></tr>
                <tr><td class="cardLocation l3"></td></tr>
                <tr><td class="cardLocation l4"></td></tr>
                <tr><td class="cardLocation l5"></td></tr>
                <tr><td class="cardLocation l6"></td></tr>
                <tr><td class="cardLocation l7"></td></tr>
                <tr><td class="cardLocation l8"></td></tr>
                <tr><td class="cardLocation l9"></td></tr>
                <tr><td class="cardLocation l10"></td></tr>
                <tr><td class="cardLocation l11"></td></tr>
                <tr><td class="cardLocation l12"></td></tr>
                <tr><td class="cardLocation l13"></td></tr>
            </table>
			<button id="Remove4">Remove</button>
        </td>
    </tr>
	
<button id="dealButton">Deal</button>
</table>


<BR>Move from column <input type="text" id="from_col"  /> to <input type="text" id="to_col"  /> <button id="moveButton">Move</button>

</center>
<script>
var game;

//deckType 0 for regular, 1 for spanish
var deckType = 0;
function display(game) {
console.log(game);
$( '.columnOfCards .cardLocation' ).html("");
 $.each(game.columns[0].cards, function( key, val ) {
        $( '#c0 .l'+key ).html(convertToCard(val.value, val.suit));
    });
 $.each(game.columns[1].cards, function( key, val ) {
        $( '#c1 .l'+key ).html(convertToCard(val.value, val.suit));
    });
 $.each(game.columns[2].cards, function( key, val ) {
        $( '#c2 .l'+key ).html(convertToCard(val.value, val.suit));
    });
 $.each(game.columns[3].cards, function( key, val ) {
        $( '#c3 .l'+key ).html(convertToCard(val.value, val.suit));
    });
}

function newStandardGame(){
deckType = 0;
console.log("calling newStandardGame");
$.ajax({
type: "POST",
url: "/newStandardGame",
data: JSON.stringify(game),
success: function(data, status){console.log("Data: " + data + "\nStatus: " + status);
game = data;
display(game);},
contentType:"application/json; charset=utf-8",
dataType:"json",
});
}

function newSpanishGame(){
console.log("calling newSpanishGame");
deckType = 1;
$.ajax({
type: "POST",
url: "/newSpanishGame",
data: JSON.stringify(game),
success: function(data, status){console.log("Data: " + data + "\nStatus: " + status);
game = data;
display(game);},
contentType:"application/json; charset=utf-8",
dataType:"json",
});
}

document.getElementById("newStG").addEventListener('click', newStandardGame);
document.getElementById("newSpG").addEventListener('click', newSpanishGame);

//$("#newStG").click(newStandardGame());
//$("#newSpG").click(newSpanishGame());

function convertToCard(value, suit){
	console.log("calling convertToCard");
	var returnVal;
	var returnSuit;
	var color;
	
	suit = suit.toLowerCase();
	returnVal = value;
	
	switch (suit){
		case "hearts":
			returnSuit = "&hearts";
			color = "red";
			break;
		case "spades":
			returnSuit = "&spades";
			color = "black";
			break;
		case "diamonds":
			returnSuit = "&diams";
			color = "red";
			break;
		case "clubs":
			returnSuit = "&clubs";
			color = "black";
			break;
		case "coins":
			returnSuit = "&otimes"
			color = "gold";
			break;
		case "cups":
			returnSuit = "&cup";
			color = "black";
			break;
		case "swords":
			returnSuit = "&dagger";
			color = "gold";
			break;
	}
	if (deckType == 0){
	switch (value){
		case 11:
			returnVal = "J";
			break;
		case 12:
			returnVal = "Q";
			break;
		case 13:
			returnVal = "K";
			break;
		case 14:
			returnVal = "A";
			break;
	}
	}
	else {
		switch (value){
			case 10:
				returnVal = "J";
				break;
			case 11:
				returnVal = "Q";
				break;
			case 12:
				returnVal = "K";
				break;
			
		}
	}
	
	return "<font color=" + color + ">" + returnVal + " " + returnSuit + ";</font>";
}

$.getJSON("http://localhost:8080/game", function( data ) {
game = data;
display(game);
});
$("#dealButton").click(function(){
$.ajax({
  type: "POST",
  url: "/dealGame",
  data: JSON.stringify(game),
  success: function(data, status){console.log("Data: " + data + "\nStatus: " + status);
        game = data;
        display(game);},
  contentType:"application/json; charset=utf-8",
  dataType:"json",
});
});
function removeCard(colNumber){
$.ajax({
type: "POST",
url: "/removeCard/"+colNumber,
data: JSON.stringify(game),
success: function(data, status){console.log("Data: " + data + "\nStatus: " + status);
game = data;
display(game);},
contentType:"application/json; charset=utf-8",
dataType:"json",
});
}
$("#Remove1").click(function(){
    removeCard(0);
});
$("#Remove2").click(function(){
    removeCard(1);
});
$("#Remove3").click(function(){
    removeCard(2);
});
$("#Remove4").click(function(){
    removeCard(3);
});
$("#moveButton").click(function(){
var colFrom = $("#from_col").val();
var colTo = $("#to_col").val();
$.ajax({
  type: "POST",
  url: "/moveCard/"+colFrom+"/"+colTo,
  data: JSON.stringify(game),
  success: function(data, status){console.log("Data: " + data + "\nStatus: " + status);
        game = data;
        display(game);},
  contentType:"application/json; charset=utf-8",
  dataType:"json",
});
});
</script>



</body>
</html>